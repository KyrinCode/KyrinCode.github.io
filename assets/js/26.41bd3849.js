(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{583:function(s,a,t){"use strict";t.r(a);var e=t(4),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("记录 mac 的 shell 从 bash 迁移到 zsh 和把 zsh 配置成 Geek 杀手的全过程")]),s._v(" "),t("p",[s._v("自 mac Catalina 出世半年多以来，我一直在观望，版本稳定后更新遇到的第一件事就是以后默认 shell 要更换为 zsh。那好吧，早就想找个机会上 oh-my-zsh 了。")]),s._v(" "),t("p",[s._v("趁此机会彻底把 shell 换成 zsh，再搭一个配得上我的帅气的终端主题。")]),s._v(" "),t("h2",{attrs:{id:"切换-shell"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#切换-shell"}},[s._v("#")]),s._v(" 切换 shell")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://support.apple.com/zh-cn/HT208050",target:"_blank",rel:"noopener noreferrer"}},[s._v("苹果官网给出了更改默认 shell 的建议"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("bash 是版本较早的 shell，zsh 基本兼容 bash 且功能更强大。")]),s._v(" "),t("p",[s._v("自升级到 macOS Mojave 后，发现打开终端会弹出一条警告，提示默认交互 shell 为 zsh。若仅想消除这个警告，可以将以下命令添加到 ~/.bash_profile中。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BASH_SILENCE_DEPRECATION_WARNING")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("切换 zsh 作为 shell 则在终端输入下行命令，输入密码重新打开终端生效：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("chsh -s /bin/zsh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("同理，切换回 bash：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("chsh -s /bin/bash\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("将提示符配置、描述文件及环境信息从 .bash_profile 和 .bashrc 中转移至 .zshrc 文件中。")]),s._v(" "),t("p",[s._v("其中提示符的配置在zsh中已不太一样：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Prompt color")]),s._v("\nautoload -U colors "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" colors "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开启颜色")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PROMPT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%{'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$fg")]),s._v("[yellow]%}%n%{"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$reset_color")]),s._v("%}@%{"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$fg")]),s._v("[green]%}%m %{"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$fg")]),s._v("[blue]%}%1|%~ %{"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$reset_color")]),s._v('%}%#> "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#配置提示符")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("RPROMPT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[%{'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$fg_bold")]),s._v("[yellow]%}%?%{"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$reset_color")]),s._v('%}]"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在行末显示上一命令的返回状态")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("到目前为止，已经将 shell 迁移成功。")]),s._v(" "),t("h2",{attrs:{id:"oh-my-zsh-主题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#oh-my-zsh-主题"}},[s._v("#")]),s._v(" Oh-My-Zsh 主题")]),s._v(" "),t("h3",{attrs:{id:"安裝-oh-my-zsh"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安裝-oh-my-zsh"}},[s._v("#")]),s._v(" 安裝 oh-my-zsh")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("oh-my-zsh 会将原来的 .zshrc 文件备份到 .zshrc.pre-oh-my-zsh 文件。先来配置 zsh 皮肤。")]),s._v(" "),t("h3",{attrs:{id:"安装-powerlevel10k"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-powerlevel10k"}},[s._v("#")]),s._v(" 安装 powerlevel10k")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/romkatv/powerlevel10k.git "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ZSH_CUSTOM")]),s._v("/themes/powerlevel10k\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"配置-powerlevel10k"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-powerlevel10k"}},[s._v("#")]),s._v(" 配置 powerlevel10k")]),s._v(" "),t("p",[s._v("修改 zsh 的主题为 powerlevel10k")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ZSH_THEME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"powerlevel10k/powerlevel10k"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("重启终端或者输入：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ./zshrc\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("进入powerlevel10k主题的配置问答界面，每一次想要重新配置，可以在终端输入命令：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("p10k configure\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("配置完毕后会生成 ~/.p10k.zsh 文件，编辑该文件亦可更改配置。")]),s._v(" "),t("h3",{attrs:{id:"添加-oh-my-zsh-插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加-oh-my-zsh-插件"}},[s._v("#")]),s._v(" 添加 oh-my-zsh 插件")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/zsh-users/zsh-autosuggestions",target:"_blank",rel:"noopener noreferrer"}},[s._v("zsh-autosuggestions"),t("OutboundLink")],1),s._v(" 命令自动补全插件")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/zsh-users/zsh-autosuggestions.git "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ZSH_CUSTOM")]),s._v("/plugins/zsh-autosuggestions\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("a",{attrs:{href:"https://github.com/zsh-users/zsh-syntax-highlighting",target:"_blank",rel:"noopener noreferrer"}},[s._v("zsh-syntax-highlighting"),t("OutboundLink")],1),s._v(" 终端命令语法高亮")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://github.com/zsh-users/zsh-syntax-highlighting.git "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ZSH_CUSTOM}")]),s._v("/plugins/zsh-syntax-highlighting\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("安装 "),t("a",{attrs:{href:"https://github.com/wting/autojump",target:"_blank",rel:"noopener noreferrer"}},[s._v("autojump"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("brew "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" autojump\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"配置插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置插件"}},[s._v("#")]),s._v(" 配置插件")]),s._v(" "),t("p",[s._v("在~/.zshrc文件找到 plugins=(git) 修改")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("plugins")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v("\n  autojump\n  zsh-autosuggestions\n  zsh-syntax-highlighting\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("安装 zsh-autosuggestions 插件后会出现粘贴内容慢的情况，在项目的"),t("a",{attrs:{href:"https://github.com/zsh-users/zsh-autosuggestions/issues/238",target:"_blank",rel:"noopener noreferrer"}},[s._v("issues#238"),t("OutboundLink")],1),s._v(" 中有讨论，将如下代码加入到 ~/.zshrc 中。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This speeds up pasting w/ autosuggest")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://github.com/zsh-users/zsh-autosuggestions/issues/238")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("pasteinit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("OLD_SELF_INSERT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${${(s."),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(".)widgets"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("self-insert"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2,3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  zle -N self-insert url-quote-magic "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# I wonder if you'd need `.url-quote-magic`?")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function-name function"}},[s._v("pastefinish")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  zle -N self-insert "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$OLD_SELF_INSERT")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nzstyle :bracketed-paste-magic paste-init pasteinit\nzstyle :bracketed-paste-magic paste-finish pastefinish\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("zsh-syntax-highlighting 默认的合法命令是绿色，在终端如果比较晃眼可以在 ~/.zshrc 文件添加：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("ZSH_HIGHLIGHT_STYLES"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arg0"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("fg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#fg=color 是按照xterm-256color设置，15是白色")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("xterm-256color 可以对照"),t("a",{attrs:{href:"https://upload.wikimedia.org/wikipedia/commons/1/15/Xterm_256color_chart.svg",target:"_blank",rel:"noopener noreferrer"}},[s._v("该表"),t("OutboundLink")],1),s._v("查看。")]),s._v(" "),t("h3",{attrs:{id:"还原环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#还原环境变量"}},[s._v("#")]),s._v(" 还原环境变量")]),s._v(" "),t("p",[s._v("将 .zshrc.pre-oh-my-zsh 文件中的内容复制回 .zshrc 文件。")]),s._v(" "),t("p",[s._v("刷新环境变量：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/.zshrc\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);